{% extends 'base.html' %}

{% block title %}Contact - {{ block.super }}{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto px-4 py-12">
    <div class="bg-white rounded-lg shadow-lg overflow-hidden">
        <div class="md:flex">
            <!-- Contact Form -->
            <div class="w-full md:w-2/3 p-8">
                <h1 class="text-3xl font-bold text-gray-800 mb-6">Get In Touch</h1>
                <p class="text-gray-600 mb-8">Have a question or want to work together? Fill out the form below and I'll get back to you as soon as possible.</p>
                
                <form method="post" class="space-y-6">
                    {% csrf_token %}
                    
                    {% if messages %}
                        {% for message in messages %}
                            <div class="p-4 mb-6 rounded-md {% if message.tags == 'success' %}bg-green-100 text-green-800 border border-green-200{% else %}bg-red-100 text-red-800 border border-red-200{% endif %} relative" id="message-{{ forloop.counter }}">
                                <button type="button" class="absolute top-2 right-2 text-gray-500 hover:text-gray-700 focus:outline-none" onclick="dismissMessage('message-{{ forloop.counter }}')">
                                    <i class="fas fa-times"></i>
                                </button>
                                <div class="pr-8">
                                    {{ message }}
                                </div>
                            </div>
                        {% endfor %}
                    {% endif %}
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label for="id_name" class="block text-sm font-medium text-gray-700 mb-1">Name *</label>
                            <input type="text" name="name" id="id_name" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent" placeholder="Your full name">
                            {% if form.name.errors %}
                                <p class="mt-1 text-sm text-red-600">{{ form.name.errors.0 }}</p>
                            {% endif %}
                        </div>
                        <div>
                            <label for="id_email" class="block text-sm font-medium text-gray-700 mb-1">Email *</label>
                            <input type="email" name="email" id="id_email" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent" placeholder="your.email@example.com">
                            {% if form.email.errors %}
                                <p class="mt-1 text-sm text-red-600">{{ form.email.errors.0 }}</p>
                            {% endif %}
                        </div>
                    </div>
                    
                    <div>
                        <label for="id_subject" class="block text-sm font-medium text-gray-700 mb-1">Subject *</label>
                        <input type="text" name="subject" id="id_subject" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent" placeholder="What's this about?">
                        {% if form.subject.errors %}
                            <p class="mt-1 text-sm text-red-600">{{ form.subject.errors.0 }}</p>
                        {% endif %}
                    </div>
                    
                    <div>
                        <label for="id_message" class="block text-sm font-medium text-gray-700 mb-1">Message *</label>
                        <textarea name="message" id="id_message" rows="5" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent resize-vertical" placeholder="Tell me about your project or question..."></textarea>
                        {% if form.message.errors %}
                            <p class="mt-1 text-sm text-red-600">{{ form.message.errors.0 }}</p>
                        {% endif %}
                    </div>
                    
                    <div class="pt-2">
                        <button type="submit" class="w-full bg-indigo-600 text-white py-3 px-6 rounded-lg hover:bg-indigo-700 transition-colors font-medium">
                            Send Message
                        </button>
                    </div>
                </form>
            </div>
            
            <!-- Contact Info -->
            <div class="w-full md:w-1/3 bg-gray-50 p-8">
                <h2 class="text-xl font-semibold text-gray-800 mb-6">Contact Information</h2>
                
                {% if profile %}
                    <div class="space-y-6">
                        <div class="flex items-start">
                            <div class="flex-shrink-0 bg-indigo-100 p-2 rounded-full text-indigo-600">
                                <i class="fas fa-envelope text-lg"></i>
                            </div>
                            <div class="ml-4">
                                <h3 class="text-sm font-medium text-gray-500">Email</h3>
                                <a href="mailto:tingzlarry@gmail.com?subject=Portfolio Contact&body=Hello Lawrence," 
                                   class="text-indigo-600 hover:text-indigo-800 transition-colors flex items-center">
                                    <i class="fas fa-external-link-alt mr-2"></i> Send Email
                                </a>
                            </div>
                        </div>
                        
                        {% if profile.location %}
                        <div class="flex items-start">
                            <div class="flex-shrink-0 bg-indigo-100 p-2 rounded-full text-indigo-600">
                                <i class="fas fa-map-marker-alt text-lg"></i>
                            </div>
                            <div class="ml-4">
                                <h3 class="text-sm font-medium text-gray-500">Location</h3>
                                <p class="text-gray-700">Nairobi</p>
                            </div>
                        </div>
                        {% endif %}
                        
                        <div class="pt-4">
                            <h3 class="text-sm font-medium text-gray-500 mb-3">Connect with me</h3>
                            <div class="flex space-x-4">
                                {% if profile.github_url %}
                                    <a href="{{ profile.github_url }}" target="_blank" class="text-gray-500 hover:text-gray-700">
                                        <i class="fab fa-github text-2xl"></i>
                                    </a>
                                {% endif %}
                                {% if profile.linkedin_url %}
                                    <a href="{{ profile.linkedin_url }}" target="_blank" class="text-gray-500 hover:text-gray-700">
                                        <i class="fab fa-linkedin text-2xl"></i>
                                    </a>
                                {% endif %}
                                {% if profile.twitter_url %}
                                    <a href="{{ profile.twitter_url }}" target="_blank" class="text-gray-500 hover:text-gray-700">
                                        <i class="fab fa-twitter text-2xl"></i>
                                    </a>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                {% else %}
                    <p class="text-gray-600">Please add your contact information to the admin panel.</p>
                {% endif %}
                
                <div class="mt-8 pt-6 border-t border-gray-200">
                    <h3 class="text-sm font-medium text-gray-500 mb-3">Office Hours</h3>
                    <p class="text-sm text-gray-600">
                        Monday - Friday<br>
                        9:00 AM - 5:00 PM EST
                    </p>
                    <p class="mt-2 text-sm text-gray-500">
                        I typically respond within 24-48 hours on weekdays.
                    </p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Map Section -->
    <div class="mt-12 bg-white rounded-lg shadow-lg overflow-hidden">
        <div class="h-64 md:h-96">
            <iframe 
                src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3988.8176405935!2d36.8219!3d-1.2921!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x182f10d22c4e4c4b%3A0x4b4b4b4b4b4b4b4b!2sAzure%20Towers%2C%20Nairobi!5e0!3m2!1sen!2ske!4v1640995200000!5m2!1sen!2ske"
                width="100%" 
                height="100%" 
                style="border:0;" 
                allowfullscreen="" 
                loading="lazy" 
                referrerpolicy="no-referrer-when-downgrade">
            </iframe>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
// Dismiss message function
function dismissMessage(messageId) {
    const messageElement = document.getElementById(messageId);
    if (messageElement) {
        messageElement.style.transition = 'opacity 0.3s ease';
        messageElement.style.opacity = '0';
        setTimeout(() => {
            messageElement.remove();
        }, 300);
    }
}

// Clear form after successful submission
document.addEventListener('DOMContentLoaded', function() {
    // Check if there's a success message and clear the form
    const successMessage = document.querySelector('.bg-green-100');
    if (successMessage) {
        // Clear all form fields
        const form = document.querySelector('form');
        if (form) {
            form.reset();
        }
    }
    
    // Add input classes to form fields
    const inputs = document.querySelectorAll('input, textarea, select');
    inputs.forEach(input => {
        // Skip if already has a class
        if (input.className.includes('form-')) return;
        
        const baseClasses = 'w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent';
        
        if (input.tagName === 'TEXTAREA') {
            input.className = `${baseClasses} form-textarea`;
        } else if (input.type === 'select') {
            input.className = `${baseClasses} form-select`;
        } else {
            input.className = `${baseClasses} form-input`;
        }
    });
});
</script>
{% endblock %}
